using DSForces
using BioSequences
using StatsBase
using Test

# test ComputeAlpha
@testset "compute alpha" begin
    test1 = LongDNA{4}("AACCGGTT")
    @test DSForces.ComputeAlpha(test1) ≈ 0.375

    test2 = LongDNA{4}("AACCCCAA")
    @test DSForces.ComputeAlpha(test2) ≈ 0.

    test3 = LongDNA{4}("GGCCCCGG")
    @test DSForces.ComputeAlpha(test3) ≈ 0.5

    test4 = LongDNA{4}("GTTTG")
    @test DSForces.ComputeAlpha(test4) ≈ 0.48

    test5 = LongDNA{4}("GTCTCTGA")
    @test DSForces.ComputeAlpha(test5) ≈ 0.40625

    test_N = LongDNA{4}("AACCNGGTT")
    @test DSForces.ComputeAlpha(test_N) == 0.
end

# test FindLongestComplementarySegment
@testset "find longest complementary segment" begin
    test1 = LongDNA{4}("AACCGGTT")
    @test DSForces.FindLongestComplementarySegment(test1) == 4
    poss1 = DSForces.FindLongestComplementarySegment(test1, true)
    @test  (poss1[1] == 1:4) & (poss1[2] == 5:8)

    test2 = LongDNA{4}("CCAAAGG")
    @test DSForces.FindLongestComplementarySegment(test2) == 2
    poss2 = DSForces.FindLongestComplementarySegment(test2, true)
    @test  (poss2[1] == 1:2) & (poss2[2] == 6:7)

    test3 = LongDNA{4}("CAACCCAGAAGGGG")
    @test DSForces.FindLongestComplementarySegment(test3) == 3
    poss3 = DSForces.FindLongestComplementarySegment(test3, true)
    @test  (poss3[1] == 4:6) & (poss3[2] == 11:13)

    test4 = LongDNA{4}("AAAAACCCCC")
    @test DSForces.FindLongestComplementarySegment(test4) == 0 broken=true
    poss4 = DSForces.FindLongestComplementarySegment(test4, true)
    @test  (poss4[1] == length(test4):length(test4)) & (poss4[2] == length(test4):length(test4))
end

# test ComputeDSForce by comparing with old results
@testset "Compute DS force on examples" begin
    # chr1, 199000 -> 201999
    test1 = "CAGTGGGTAACTGTAATTCATTCTAGGTCTGCGATATTTCCTGCCTATCCATTTTGTTAACTCTTCAATGCATTCCACAAATACCTAAGTATTATTTAATAATGGTGGGTTTTTTTTTTTTGCATCTATGAAGTTTTTTCAAATTCTTTTTAAGTGACAAAACTTGTACATGTGTATCGCACAATATTTCTAGTCGACAGCACTGCTTTACAGAATGTAAACCGTGCACTCCCAGGAAAATGCAGACACAGCACGCCTCTTTGGGACCGCGGTTTATACTTTCGAAGTGCTCGGAGCCCTTCCTCCAGACCGTTCTCCCACACCCCGCTCCAGGGTCTCTCCCGGAGTTACAGGCCTCGCTGTAGGCCCCGGGAACCCAACGCGGTGTCAGAGAAGTGGGGTCCCCTACGAGGGACCAGGAGCTCCGGGCGGGCAGCAGCTGCGGAAGAGCCGCGCGAGGCTTCCCAGAACCCGGCCGGGGCGGGAAGACGCAGAAGTGGGGAGGCGGAACCGGGACCCCGCAGAGCCCGGGTCCCTGCGCCCCACAAGCCTTGGCTTCCCTGCTAGGGCCGGGCAAGGCCGGGTGCAGGGCGCGGCTCCAGGGAGGAAGCTCCGGGGCGAGCCCAAGACGCCTCCCGGGCGGTCGGGGCCCAGCGGCGGCGTTCGCAGTGGAGCCGGGCACCGGGCAGCGGCCGCGGAACACCAGCTTGGCGCAGGCTTCTCGGTCAGGAACGGTCCCGGGCCTCCCGCCCGCCTCCCTCCAGCCCCTCCGGGTCCCCTACTTCGCCCCGCCAGGCCCCCACGACCCTACTTCCCGCGGCCCCGGACGCCTCCTCACCTGCGAGCCGCCCTCCCGGAAGCTCCCGCCGCCGCTTCCGCTCTGCCGGAGCCGCTGGGTCCTAGCCCCGCCGCCCACAGTCCGCCCGCGCCTCCGGGTCCTAACGCCGCCGCTCGCCCTCCGCTGCGCCCTCCCCGAGCGCGGCTCCAGGACCCCGTCGACCCGGAGCGCTGTCCTGTCGGGCCGAGTCGCGGGCCTGGGCACGGAACTCACGCTCACTCCGAGCTCCCGACGTGCACACGGCTCCCATGCGTTGTCTTCCGAGCGTCAGGCCGCCCCTACCCGTGCTTTCTGCTCTGCAGACCCTCTTCCCAGACCTCCGTCCTTTGTCCCATCGCTGCCTTCCCCTCAAGCTCAGGGCCAAGCTGTCCGCCAGCCTCGGCTCCTCCGGGCAGCCCTTGCCCGGGGTGCGCCCCGGGGCAGGACCCCCAGCCCAGGCCCAGGGCCCGCCCCTGCCCTCCAGCCCTACGCCTTGACCCGCTTTCCTGCGTCTCTCAGCCTACCTGACCTTGTCTTTACCTCTGTGGGCAGCTCCCTTGTGATCTGCTTAGTTCCCACCCCCCTTTAAGAATTAAATAGAGAAGCCAGACGCAAAACTACAGATATCGTATGAGTCCAGTTTTGTGAAGTGCCTAGAATAGTCAAAATTCACAGAGACAGAAGCAGTGGTCGCCAGGAATGGGGAAGCAAGGCGGAGTTGGGCAGCTCGTGTTCAATGGGTAGAGTTTCAGGCTGGGGTGATGGAAGGGTGCTGGAAATGAGTGGTAGTGATGGCGGCACAACGGTGTGAATCTACTTAATCCCACTGAACTGTATGCTGAAAAATGGTTTAGACGGTGAATTTTAGGTTATGTATGTTTTACCACAGTTTTTAAAAAGCTAGTGAAAAGCTGGTAAAAAGAAAGAAAAGAGGCTTTTTTAAAAAGTTAAATATATAAAAAGAGCATCATCAGTCAAGTCCAGCAGTTGTCCCTCCTGGAATCCGTTGGCTTGCCTCCGGCATTTTTGGCCCTTGCCTTTTAGGGTTGCCAGATTAAAAGACAGGATGCCCAGCTAGTTTGAATTTTAGATAAACAACGAATAATTTCGTAGCGTAAATATGTCCCAAGCTTAGTTTGGGACATACTTATGCTAAAAAACATTATTGGTTGTTTATCTGAGATTCAGAATTAAGCATTTTATATTTTATTTGCTGCCTCTGGCCACCCTACTCTCTTCCTAACACTCTCTCCCTCTCCCAGTTTTGTCCGCCTTCCCTGCCTCCTCTTCTGGGGGAGTTAGATCGAGTTGTAACAAGAACATGCCACTGTCTCGCTGGCTGCAGCGGGTGGTCCCCTTACCAGAGGTAAAGAAGAGATGGATCTCCACTCATGTTGTAGACAGAATGTTTATGTCCTCTCCAAATGCTTATGTTGAAACCCTAACCCCTAATGTGATGGTATGTGGAGATGGGCCTTTGGTAGGTAATTACGGTTAGATGAGGTCATGGGGTGGGGCCCTCATTATAGATCTGGTAAGAAAAGAGAGCATTGTCTCTGTGTCTCCCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCATTTCTCTCTATCTCATTTCTCTCTCTCTCTCTATCTCATTTTTCTCTCTCTCTCTTTCTCTCCTCTGTCTTTTCCCACCAAGTGAGGATGCGAAGAGAAGGTGGCTGTCTGCAAACCAGGAAGAGAGCCCTCACCGGGAACCCGTCCAGCTGCCACCTTGAACTTGGACTTCCAAGCCTCCAGAACTGTGAGGGATAAATGTATGATTTTAAAGTCGCCCAGTGTGTGGTATTTTGTTTTGACTAATACAACCTGAAAACATTTTCCCCTCACTCCACCTGAGCAATATCTGAGTGGCTTAAGGTACTCAGGACACAACAAAGGAGAAATGTCCCATGCACAAGGTGCACCCATGCCTGGGTAAAGCAGCCTGGCACAGAGGGAAGCACACAGGCTCAGGGCTCTGCTATTCATTCTTTGTGTGACCCTGGGCAAGCCATGAATGGAGCTTCAGTCACCCCATTTGTAATGGGATTTAATTGTGCTTGCCCTGCCTCCTTTTGAGGGCTGTAGAGAAAAGATGTCAAAGTATTTTGTAATCTGGCTGGGCGTGGTGGCTCATGCCTGTAATCCCAGCACTTTGGT"
    @test DSForces.FindLongestComplementarySegment(LongDNA{4}(test1)) == 21
    @test DSForces.ComputeDSForce(test1) ≈ 0.291 atol = 0.001

    # chr1, 2218000 -> 2220999
    test2 = "ACATCTGTAGATTCTTCACTTGGCAAAAGTCACTTTCTTGTTTTTTGATATATGATCTGAAGGCTATAACATTCTACGTACCATGTAAGCTACATCCAGGAATTTTCATTGACAGTGTTTTCATTATCATTCAATTTAAAACATTTTGTGGTTTCCATTTTGATCCCTTCTTTAATTGATGATGTGTCCAAAGTATTTTGCAATGTCCCAGATAATGGTGATTTTTGATGGGAATGTGTATTTTTCTTTGTTATTTATTTTTATTTATTTTTTTGAGATGGAGTCTCGCTGTCACCCAGGCTGAAGTGCAGTGGCGCGATCTCAGCTCACTGCAACCTCTGCTTCCTGGGTACAAGTGATTCTCCTGCCTCAGCCTCCTGAGTAGCTGGGACTGTAGGCACATGCCACCATACCTGGCTAATTTTTGTATTTTTAGTAGAGACAGGGTTTCACCAGGCTGGTCTCAAACTCCTGCCCTCAGGTGATCCGCCCACCTCAGCCTACCAAAGTGCTGGGATTACAGGTGTGAGCCACTGCCCTCAGCCTGTTATTTTTAGTTTGGAATTCTAGTGTGTTTCTTTATTTTAATAGTTACCAAAGAAATACAGATACATAGATAAAAGAAACAAAAAGAACCCCCAAAGTTAGTACAGTTTAAATACTGAAACTGTAGAATCTGTAGAAACTATTGTCTCTGTGGAACTCACCAAGCCCTGGCCCTCCTTTGCTCCTCCATTACGGCCCTAGCGTCAGCTTCTTTCAAAGCTTTCACCCATTTTTTTTTGTCTTAGCTCTCTCCATACTTCTCAATTATGTGCTCTTGCTGCTCCTCCTTGGTTTAGCAGCTTTATACATGGTGAGATGTTACTGGAGAATGAGGGTTTTGCTCTTATCCAATGCTCCCTGCCCCACCCTACCATCTCTTCTTCTGTCTTCCCAAATGAGCAATTTCCTCATTTTTGTTTAAGTTGATGTCTCTATTATAATTTGTACTATAACTCTCTGCTGAGTCAAGTAGTGAACTCTGCTTAGGTTTTCTCTTTATTTTTCCTGGAGTTAGTAGTGGCCTTGCTTTCTTCTGTCATCTGCTGAGTTTCCTCTGTGCCTATGGCCCATCCCACCTACCTCTTCCAACAAGCCCTCCACACAGTGTTTGATCTAGTCAGTTGCATCCTACCTTCCACTGGTTCCTTGTTTTCCTGGAGCCCTGTGTCCTTCTGGCTTAGTCTGGGCTGCTTACTCTCTGGGCTCCATGTCTAGGCTGGTGGGCAGAGATTTCCATTTCCCCTTCATGGACTGGGACAGACCCTTCTTAGCTCTTATTGTTATGATGGAAGCCCAGTTCCAGATCCCATTCAGAAAGGGCCTGTGGCCATGACTCTTGTCTCTCACTGGCCTTAACCAGCAGCCCTCAGTGGACGTGAGACCAGGCCCAAGGCTTGCATTGGCAGTTTGGTTTCCACTCTTGCTTACCACTGTGGCTTGAGTGCTATCTTCATTTCTAGCTCTGCACAGCTACCTTCCTTGTGCCTTTTTACAGGACATTTAAAAAACAAATCTGGCCAGGCGAGGTGGCTCACACCTGTAATCCCAGCACTTTGGGAGGCTGAGGCGGGCAGATCATGAGGTCAGGAAATCAAGACCATCCTGGCTAACATGGTGAAACCCTGTCTCTACTAAAAAATACAAAAAAAATTAGCTGGGCATGGTGGCGGGTGCCTGTAGTCCCAGCTACTCAGGAGGCTGAGGCAGGAGAATGGTGTGAACCCAGGAGGCGGAGCTTGCAGTGAGCCGAGATTGTGCCACTGCACTCCAGCCTGGGAAACAGAGCGAGAGAGTGAGACTCTGTCTCAAAAACAAAACAAAACAAAACAAAAAAACCAAATCTGGCCAGGCGAGGTGGCTCACACCTGTAATCCCAGCACTTTGGGAGGCCGAGGCAGGTGGATCACCTGAGGTCAGGCGTTTGAGACCAACCTGGCCAACATGTCAAAACCCCATCTCTACTAAAAAAAATACAAAAATTAGCTGGGCATGATGACGGGTGCTTGTAATCCCAGCTACTCAGGAGGCTGAGGCAGGAGAATCGCTTGAACCCGAGAGGCAGAGTTTACACAGAGCCGAGATTGCGCCACTGCACTCCAGCCTGGGTGACACAACGAGACTCTGTCTCAAAAAAAAAAAAAAAAAAAAATGGCCGGGCACAGTGGCTCACGCCTTTAATCCCAGTGCTTTGGGAGGCCGAGCTGGGCGGATCACAAGGTCAGGAGATCAAGACCATCCTGGCTAACACAGTGAAACCCTGTCTCTACTAAAAATACAAAAAATTAGCCGGGCGTGGTGGCGGGCGCCTATAATCCCAGCTACTCGGGAAGCTAAGGCAGGAGAATCGCTTGAACCCAGGAGGTGGAGGTTGTAGTGAGCCGAGATCGCGCCACTGCACTCCAGCCTGTGTGACAGAGCGAGACTCGGTCTCAAAAAAAAAAAAAAAAAAAGCAAATCTATTTTACCCAGCATGTGTTTGTGCTTGGACTAGGAAGGGGACCCTGCACCATCTTGGCTGGGGTTGTAGCAGATGCTCTGGTGTCCTGTGGCTCCTCCGCCCCACCCTCACAGCGCCCCACTGCAGGGCTGCAGTCAGAAGCCTCAGGTTGCAGCCTGCCCGACAGCTCAAGCTCAGCAGGGCCGAATGGAGAATGTGTACCTCCTCCTCCTAACATTGTTAAAAATAAAATTTGTATTTTGACACAATCTCAAGCTTATAGAAAAGTTGCAAGAATAGTACAGGAACTTTTTTTCCCCTGAAGCATTTGAGGGTTTGTTGCCGCATGGTGCTCACCACACCCCAAAACAAGGACATTCTCCTACACGCCCCAACACGGCTGTCCAAGGCGGGAAATCACGTGGAGTCAGACCCCACTCTGGGCTTTCTGGTTGTCCCAGTAATATCCCTTGCAGTAAAGAGATCAGCCTGGGACCACACATTGCACTGAGGTGCCA"
    @test DSForces.FindLongestComplementarySegment(LongDNA{4}(test2)) == 43
    @test DSForces.ComputeDSForce(test2) ≈ 0.630 atol = 0.001

    # chr1, 362000 -> 364999
    test3 = "AGATCGAGACCATCCTGGCCAACATGGTGAAATCCCGTCTCTACTAAAATACAAAAAATTAGCTGGGCGTGGTGGTGCGCACCTATAAATCCCAGCTACTCGGGAGGCTGAGGCAGGGGAATCGCTTAAACACAGGAACCCGGGAGGCAGAGGTTGCAGTGAGCCAAGATCACACCACTGCACACCAGCCTAGTGACAGAGCAAGACTCCATCTCAAAAAACAAACAAAAAAAAAAAAAACCATCTAAAAGTAAAACTGCTGTATGATCCAGTAATTTCACTAACTGGGCCTATAGTCAAAAGAAACAAAATCAATATATCGTAAAGACATCTGCACTCTCATGTTTACTGCGGGACTACTCACAATCGCCAAAATACGGAATCAGCCTCTGAGTTCATCAGCGGATGATGGATAAACAGAACGTGGTGTGTATACACAGTGGAATATTATTCAGCCATACAGAGGAACGACAGCCTGTTATTTGTACAAGATGGAACTAGGGATCATTATGTTAAGTGAAATAAGCCAAGCACAGAAAGACAAACATTGAATGTTCTCTCCCACCTACTAAAAAAGTAGCTCTCGTGAAGACAGAGGGTAGACGCGTGGTTACCAGAGGTGGGGAAATGTAGCGGGGAGAGGGGGAGAAAGAGAAGTTGATTGAAGGGTACAAATACGTGGTTTGATAGAAGGAATAAGACCTAGTGTTACATAGATCATAGTTGGCAATTGCCTACTGTATATTTCAAAATGGCTAGAAGAGAAGAATCGGAACGGTTCTAGCATAAAGCAAAAACAAATATTTAAGGCGATAGATATTCCAAGTAGGCTGATTTGATTTTCACAATTATATGAATGCATTAAACTATCACATGTACCCTGAAACTATGTACATCTATTATGCATCAGTGAAAAAGAAAAAAGAAACAAGAACTTAGATTTTAAACTCAGCACTCTCCTAGTGGGCTCCTTAAAAATATTTTTGTTTGGGAGGACAAAGTAGGAGGATTCCTTGAGCCCGGGAGCTTGAGGCTGCAGTGAGATAGTGCCACTGCACTCCAGCCTGAGCGACAGAGAGATACACTGGCTCTAAATATAAATAATATAAATATATATTTATGGAATAAATAAATGAATAAAATATCTTTGCATGCTGGTGAGCCCAGGGTACAGTCTGCCCTTGGCAGCTCGGTGACTCAGCCAAGGCGGCTAAACAATCCTCGCCCACTAGACAGTGGAGGTCGCCCTCCAGAGGACCTTATCAGATGTACGTGCAAAGCAGTTTTCAAGACAGTTTTCTATTCAGAGTGTGGTTTAGCCGTTCAGGGAGAGAGATCACAAAGGAAAACCACCTTTAGGAAAGCAGGTGAGAAAGGTGTAAGTTCCCAGGCTTGGGGGTCCTGGCCCAGCCTAGCTGTGGGCAACCCCGGGAAGGCTGAGCCCCGCAGGCTGTATGGACAAAGCATCTCGCTTTCCACACTGGCCACAGGTCTATCCCTGGCAGTAAACAGGTCACAGGTGGGCAGCAGGTCTAACACCTGTAGCGAAAGAACGCAGGAGAGGAACTGAGGCTCTGCTACCAGCAGATGCTCCAAGCACATCCCACGGGGAGGACCATGAACAACTCAGCTGGCCACAACCAGGAAAAGGGTGTCCAGGGCCTCAGAGCTGCTTCAGTGGGGCCATTTCCAGGCTCCCAAGCAGTAATGTGGGTGCCCTCTCAAGAACAGAAGCGGAACAGCCTAACGCTAATGTTTGGGAAGAAGAGAACAGTGATCCCCCTGGTTACCTCCCATCTCTCTCTGCAGTTCTCATGCATCTGTGCACACACGCTCACACACACATATGTCCATCAATCCACTCACAATGTTTGACTTAAAGCAGAAACCATATAAAGGGCAGGATAAGGAGAAAAGACGAAAGGAACTGAAAAGATGCAAACAGCCACTAACACGCCAATTTGCACCTTGCACAGGGCCTGGGAAGTAATGACACGGCTTCTCGTTATGCATCAATGATCTCATGTTTTCATTTTAACAAACACCCTAATACAAAAATAGGCTTTATAGGGAGGAGAGAAAATATGTTTTATAGGGAGGAGAGAAAAGCCATTCTGAAGAGCTGGATAGGTTGCCTTTGGCCCACATGGAGTCAGCCCCCTGCCCACGCCACCAGGCTCACGTTCAGGGCCCTGGCTGGAGAAACCTGAGCTGCAGGACCCGCTGCCCACCAATGCAGAAGAGAAGGCAGTATGCTTTTTGCATTGGGTGGAACAAAAACAGAAGAAATGGGAATTTGGTGAGAAATAAGGGAGGTGGTCCTCAGAATCTGCAGAGCAGTGGCTTCCAAACTCTGTGATGCAACCCCAGCCAGAAAAACACTTTACATCATGGCTGAGGGCACATACATGCACGCACATATGCACAATACAGGAAATCTGGAATACAGAAAGCCCTGGAATTCCTAAATAACATCCTGCCCACATGGGAATTCTGCCCTAGCTGATGGCTTCTCCGAGGCCTAGGCCCAAATCCACACCTGCTGTTTAGCCCAGAGCCAAGCCTAGGAGTGTAGGGTCCCCTATGCATGGGTGTCCAACCCCATCCCTGTCCGGAATAGCACGGGTGCTTCTCGGTGCCACAAATGTTGGTGGCGGCTGGGGAGGAGTGGTTCCTCCAAGGCTCCATGCCTGCCTCCACCACTGAGGCCAGCACGGTGGGACTGGGCTAGGGAGACAGGCAGGCTGGCCTACCCACTGAAGGAGCCAGTCTGCTTCCACCTAGTCAGCAGCTCCAGGGAGCGCATCTCCCTCCAGGAAGGGCAGGAGGCCAAGAGGAGCTGGAAAGGTGGGCATTTGATATCATGAGGTATAAAGAGAGCTCCTAGGGGTCCCAGACATCAACTAATAAAAGCACCTCAGAAGTTCATAGATGGGGAAATAGCTGTGTGAATATACCGTGTTATCCAAGTCATGCGGAGAGGAAGGGCTCGAACCCATG"
    @test DSForces.FindLongestComplementarySegment(LongDNA{4}(test3)) == 12
    @test DSForces.ComputeDSForce(test3) ≈ -0.077 atol = 0.001
end

# test ComputeDSForce on sliding window and compare with single-window computation
@testset "Compute DS force on examples (sliding window)" begin
    # chr1, 199000 -> 201999
    test1 = "CAGTGGGTAACTGTAATTCATTCTAGGTCTGCGATATTTCCTGCCTATCCATTTTGTTAACTCTTCAATGCATTCCACAAATACCTAAGTATTATTTAATAATGGTGGGTTTTTTTTTTTTGCATCTATGAAGTTTTTTCAAATTCTTTTTAAGTGACAAAACTTGTACATGTGTATCGCACAATATTTCTAGTCGACAGCACTGCTTTACAGAATGTAAACCGTGCACTCCCAGGAAAATGCAGACACAGCACGCCTCTTTGGGACCGCGGTTTATACTTTCGAAGTGCTCGGAGCCCTTCCTCCAGACCGTTCTCCCACACCCCGCTCCAGGGTCTCTCCCGGAGTTACAGGCCTCGCTGTAGGCCCCGGGAACCCAACGCGGTGTCAGAGAAGTGGGGTCCCCTACGAGGGACCAGGAGCTCCGGGCGGGCAGCAGCTGCGGAAGAGCCGCGCGAGGCTTCCCAGAACCCGGCCGGGGCGGGAAGACGCAGAAGTGGGGAGGCGGAACCGGGACCCCGCAGAGCCCGGGTCCCTGCGCCCCACAAGCCTTGGCTTCCCTGCTAGGGCCGGGCAAGGCCGGGTGCAGGGCGCGGCTCCAGGGAGGAAGCTCCGGGGCGAGCCCAAGACGCCTCCCGGGCGGTCGGGGCCCAGCGGCGGCGTTCGCAGTGGAGCCGGGCACCGGGCAGCGGCCGCGGAACACCAGCTTGGCGCAGGCTTCTCGGTCAGGAACGGTCCCGGGCCTCCCGCCCGCCTCCCTCCAGCCCCTCCGGGTCCCCTACTTCGCCCCGCCAGGCCCCCACGACCCTACTTCCCGCGGCCCCGGACGCCTCCTCACCTGCGAGCCGCCCTCCCGGAAGCTCCCGCCGCCGCTTCCGCTCTGCCGGAGCCGCTGGGTCCTAGCCCCGCCGCCCACAGTCCGCCCGCGCCTCCGGGTCCTAACGCCGCCGCTCGCCCTCCGCTGCGCCCTCCCCGAGCGCGGCTCCAGGACCCCGTCGACCCGGAGCGCTGTCCTGTCGGGCCGAGTCGCGGGCCTGGGCACGGAACTCACGCTCACTCCGAGCTCCCGACGTGCACACGGCTCCCATGCGTTGTCTTCCGAGCGTCAGGCCGCCCCTACCCGTGCTTTCTGCTCTGCAGACCCTCTTCCCAGACCTCCGTCCTTTGTCCCATCGCTGCCTTCCCCTCAAGCTCAGGGCCAAGCTGTCCGCCAGCCTCGGCTCCTCCGGGCAGCCCTTGCCCGGGGTGCGCCCCGGGGCAGGACCCCCAGCCCAGGCCCAGGGCCCGCCCCTGCCCTCCAGCCCTACGCCTTGACCCGCTTTCCTGCGTCTCTCAGCCTACCTGACCTTGTCTTTACCTCTGTGGGCAGCTCCCTTGTGATCTGCTTAGTTCCCACCCCCCTTTAAGAATTAAATAGAGAAGCCAGACGCAAAACTACAGATATCGTATGAGTCCAGTTTTGTGAAGTGCCTAGAATAGTCAAAATTCACAGAGACAGAAGCAGTGGTCGCCAGGAATGGGGAAGCAAGGCGGAGTTGGGCAGCTCGTGTTCAATGGGTAGAGTTTCAGGCTGGGGTGATGGAAGGGTGCTGGAAATGAGTGGTAGTGATGGCGGCACAACGGTGTGAATCTACTTAATCCCACTGAACTGTATGCTGAAAAATGGTTTAGACGGTGAATTTTAGGTTATGTATGTTTTACCACAGTTTTTAAAAAGCTAGTGAAAAGCTGGTAAAAAGAAAGAAAAGAGGCTTTTTTAAAAAGTTAAATATATAAAAAGAGCATCATCAGTCAAGTCCAGCAGTTGTCCCTCCTGGAATCCGTTGGCTTGCCTCCGGCATTTTTGGCCCTTGCCTTTTAGGGTTGCCAGATTAAAAGACAGGATGCCCAGCTAGTTTGAATTTTAGATAAACAACGAATAATTTCGTAGCGTAAATATGTCCCAAGCTTAGTTTGGGACATACTTATGCTAAAAAACATTATTGGTTGTTTATCTGAGATTCAGAATTAAGCATTTTATATTTTATTTGCTGCCTCTGGCCACCCTACTCTCTTCCTAACACTCTCTCCCTCTCCCAGTTTTGTCCGCCTTCCCTGCCTCCTCTTCTGGGGGAGTTAGATCGAGTTGTAACAAGAACATGCCACTGTCTCGCTGGCTGCAGCGGGTGGTCCCCTTACCAGAGGTAAAGAAGAGATGGATCTCCACTCATGTTGTAGACAGAATGTTTATGTCCTCTCCAAATGCTTATGTTGAAACCCTAACCCCTAATGTGATGGTATGTGGAGATGGGCCTTTGGTAGGTAATTACGGTTAGATGAGGTCATGGGGTGGGGCCCTCATTATAGATCTGGTAAGAAAAGAGAGCATTGTCTCTGTGTCTCCCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCATTTCTCTCTATCTCATTTCTCTCTCTCTCTCTATCTCATTTTTCTCTCTCTCTCTTTCTCTCCTCTGTCTTTTCCCACCAAGTGAGGATGCGAAGAGAAGGTGGCTGTCTGCAAACCAGGAAGAGAGCCCTCACCGGGAACCCGTCCAGCTGCCACCTTGAACTTGGACTTCCAAGCCTCCAGAACTGTGAGGGATAAATGTATGATTTTAAAGTCGCCCAGTGTGTGGTATTTTGTTTTGACTAATACAACCTGAAAACATTTTCCCCTCACTCCACCTGAGCAATATCTGAGTGGCTTAAGGTACTCAGGACACAACAAAGGAGAAATGTCCCATGCACAAGGTGCACCCATGCCTGGGTAAAGCAGCCTGGCACAGAGGGAAGCACACAGGCTCAGGGCTCTGCTATTCATTCTTTGTGTGACCCTGGGCAAGCCATGAATGGAGCTTCAGTCACCCCATTTGTAATGGGATTTAATTGTGCTTGCCCTGCCTCCTTTTGAGGGCTGTAGAGAAAAGATGTCAAAGTATTTTGTAATCTGGCTGGGCGTGGTGGCTCATGCCTGTAATCCCAGCACTTTGGT"
    sliding_computation = ComputeDSForce(test1, return_LCS_positions=false, sliding_window_length=1000)
    sequential_computation = [ComputeDSForce(test1[i:i+999]) for i in 1:2001]
    for (x,y) in zip(sliding_computation, sequential_computation)
        @test x ≈ y atol=1e-5
    end
end